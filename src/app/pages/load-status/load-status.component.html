<p-toast></p-toast>

<div class="app-title mb-3 p-3">
    <div>
        <h1>
            <i class="fa fa-tasks"></i> Load Status
        </h1>
    </div>
</div>

<div class="row">
    <div class="col-md-12 p-0">
        <div class="tile">
            <form [formGroup]="searchForm" (ngSubmit)="onSubmit()" class="row">
                <div class="col-8 row">
                    <h5 class="col-12">Filter by</h5>
                    <div class="col-3">
                        <p-autoComplete formControlName="SCHEMA_NAME" placeholder="Schema Name" [suggestions]="autocomplete.SCHEMA_NAME" (completeMethod)="search($event, 'SCHEMA_NAME')" (onSelect)="onSubmit($event, true)" (keyup)="onSubmit($event)"></p-autoComplete>
                    </div>
                    <div class="col-3">
                        <p-autoComplete formControlName="TABLE_NAME" placeholder="Table Name" [suggestions]="autocomplete.TABLE_NAME" (completeMethod)="search($event, 'TABLE_NAME')" (onSelect)="onSubmit($event, true)" (keyup)="onSubmit($event)"></p-autoComplete>
                    </div>
                    <div class="col-3">
                        <p-calendar (onSelect)="onSubmit($event, true)" formControlName="START_TIME" placeholder="Dag Start Time" timeOnly="true" showTime="true" name="StartTime" hourFormat="24"></p-calendar>
                    </div>
                    <div class="col-3">
                        <p-calendar [defaultDate]="defaultDate" (onSelect)="onSubmit($event, true)" formControlName="AVG_TIME" placeholder="Min. Average Time" timeOnly="true" showTime="true" name="AverageTime" hourFormat="24"></p-calendar>
                    </div>
                </div>
                <div class="col-4 row">
                    <h5 class="col-12">Time Period</h5>
                    <div class="col-6">
                        <div class="btn-group btn-group-toggle">
                            <label [ngClass]="{'active': toogleButtonPeriod === 7}" class="btn btn-info">
                                <input id="7days" type="radio" name="timePeriod" autocomplete="off" checked="" value="7" (click)="updateTimePeriod(7)"> 7 D
                            </label>
                            <label [ngClass]="{'active': toogleButtonPeriod === 30}" class="btn btn-info">
                                <input id="1month" type="radio" name="timePeriod" autocomplete="off" value="30" (click)="updateTimePeriod(30)"> 1 M
                            </label>
                            <label [ngClass]="{'active': toogleButtonPeriod === 180}" class="btn btn-info">
                                <input id="6months" type="radio" name="timePeriod" autocomplete="off" value="180" (click)="updateTimePeriod(180)"> 6 M
                            </label>
                        </div>
                    </div>
                    <div class="col-6">
                        <div class="row">
                            <select class="form-control col-6 ml-2" formControlName="ENV_NAME">
                                <option value="PRD">PRD</option>
                                <option value="DEV">DEV</option>
                            </select>
                            <i (click)="discard()" class="fa fa-refresh btn btn-dark col-3 ml-2" aria-hidden="true" title="Reset Form"></i>
                        </div>
                    </div>
                </div>
            </form>
            <div class="col-12">
                <hr>
            </div>
            <ngx-loading [show]="loader.tasks" [config]="{ backdropBorderRadius: '3px' }">
            </ngx-loading>
            <div class="mt-2 col-12" *ngIf="!loader.tasks">
                <div class="clearfix">
                    <div class="div" class="float-left mt-2">
                        <label>Show</label>
                        <select #limit name="limit" class="ml-1" (change)="changeLimit(limit.value)">
                            <option value="10" selected>10</option>
                            <option value="50">50</option>
                            <option value="100">100</option>
                            <option value="all">All</option>
                        </select>
                        <label class="ml-1">Records</label>
                    </div>
                    <img *ngIf="loader.saveTasks" class="float-right" width="40" src="assets/images/green_loader.gif" alt="Loader Image">
                    <button [ngClass]="{'disabled': !tasksMoved || loader.saveTasks}" class="float-right btn btn-success ml-2" (click)="save()">Save Changes</button>
                    <button [ngClass]="{'disabled': !tasksMoved || loader.saveTasks}" class="float-right btn btn-danger" (click)="
                    discard()">Discard Changes</button>
                </div>
                <div *ngIf="errors.updateEror" class="alert alert-danger mt-2" role="alert">
                    Could not update all records. Please try again.
                </div>
                <div class="mt-3" *ngIf="taskData.length; else elseTemplate">
                    <daypilot-gantt [config]="config"></daypilot-gantt>
                </div>
                <ng-template #elseTemplate>
                    <div class="text-center">
                        Data Not Available!
                    </div>
                </ng-template>
            </div>
        </div>
    </div>
</div>