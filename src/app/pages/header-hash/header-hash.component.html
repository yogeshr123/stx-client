<p-toast></p-toast>

<div class="app-title">
    <div>
        <h1>
            <i class="fa fa-hashtag"></i> File Header Hash
        </h1>
    </div>
</div>

<div class="row">
    <div class="col-md-12">
        <div class="tile mt-2">
            <div class="tile">
                <div *ngIf="uniqueTables?.length">
                    Table Name:
                    <p-dropdown appendTo="body" class="ml-2 col-4" [options]="uniqueTables" [(ngModel)]="selectedTable" optionLabel="TABLE_NAME" [filter]="true" filterBy="value.TABLE_NAME" (onChange)="changeTable()">
                    </p-dropdown>
                    <button [routerLink]="[ './add-header' ]" class="btn btn-sm btn-primary float-right">Add New</button>
                </div>
                <div class="table-responsive mt-4">
                    <h6>* Mismatch Table *</h6>
                    <p-table #dt1 [responsive]="true" [value]="headerMismatches" [tableStyle]="{'table-layout':'auto'}" [columns]="headerMismatchesTableCols" [reorderableColumns]="true" styleClass="scroll-table-fhh mismatch">
                        <!-- <ng-template pTemplate="caption">
                                                    <div style="text-align: left">
                                                        <p-multiSelect appendTo="body" [options]="columnTableColumns" [(ngModel)]="selectedColumns" optionLabel="field" selectedItemsLabel="{0} columns selected" [style]="{minWidth: '200px'}" defaultLabel="Choose Columns" (onChange)="saveColumnState()"></p-multiSelect>
                                                    </div>
                                                    <div class="globalSearch">
                                                        <input type="text" placeholder="Global Search" [(ngModel)]="globalQuery">
                                                        <button class="btn btn-sm btn-primary" type="button" (click)="search()">
                                                            <i class="fa fa-lg fa-fw fa-search"></i>
                                                        </button>
                                                    </div>
                                                </ng-template> -->
                        <ng-template pTemplate="header" let-columns>
                            <tr>
                                <th *ngFor="let col of columns" [pSortableColumn]="col.field">
                                    {{col.header}}
                                    <p-sortIcon [field]="col.field" ariaLabel="Activate to sort" ariaLabelDesc="Activate to sort in descending order" ariaLabelAsc="Activate to sort in ascending order">
                                    </p-sortIcon>
                                </th>
                                <!-- <th class="fixedcol rightfixedcol">Action</th> -->
                            </tr>
                            <tr>
                                <th *ngFor="let col of columns" [ngSwitch]="col.field" class="ui-flclassuid">
                                    <span *ngSwitchCase="'START_DATE'"></span>
                                    <span *ngSwitchCase="'UPDATE_DATE'"></span>
                                    <span *ngSwitchCase="'INSERT_DATE'"></span>
                                    <input #statusFilter id="statusFilter" pInputText *ngSwitchCase="'STATUS'" type="text" (input)="dt1.filter($event.target.value, col.field, col.filterMatchMode)" [value]="dt1.filters[col.field]?.value" [(ngModel)]="statusDefaultFilter">
                                    <input pInputText *ngSwitchDefault type="text" (input)="dt1.filter($event.target.value, col.field, col.filterMatchMode)" [value]="dt1.filters[col.field]?.value">
                                </th>
                                <!-- <th></th> -->
                            </tr>
                        </ng-template>
                        <ng-template pTemplate="body" let-header let-columns="columns">
                            <tr [pSelectableRow]="header">
                                <td *ngFor="let col of columns">
                                    <ng-container *ngIf="col.type === 'date'; else elseTemplate">
                                        <span> {{header[col.field] | date: 'short'}} </span>
                                    </ng-container>
                                    <ng-template #elseTemplate>
                                        <span> {{header[col.field]}} </span>
                                    </ng-template>
                                </td>
                                <!-- <td class="fixedcol rightfixedcol" style='white-space: nowrap'>
                                                            <div>
                                                                <button (click)="approveHeader(header)" title="Approve" *ngIf="header.STATUS === 'NEW'" class="btn btn-success btn-sm">
                                                                    <i class="fa fa-thumbs-up"></i>
                                                                </button>
                                                                <button [routerLink]="[ './edit-header', header.HEADER_HASH ]" title="Edit" *ngIf="header.STATUS === 'NEW'" class="btn btn-sm btn-primary btn-sm ml-1">
                                                                    <i class="fa fa-pencil"></i>
                                                                </button>
                                                                <button [routerLink]="[ './view-header', header.HEADER_HASH ]" title="view" class="btn btn-sm btn-info btn-sm ml-1">
                                                                    <i class="fa fa-eye" aria-hidden="true"></i>
                                                                </button>
                                                            </div>
                                                        </td> -->
                            </tr>
                            <!-- <tr *ngIf="!headerMismatches || !headerMismatches.length">
                                                    </tr> -->
                        </ng-template>
                    </p-table>
                    <div colspan="10" class="text-center p-2 border" *ngIf="!headerMismatches || !headerMismatches.length">
                        <h6>No Data Available!</h6>
                    </div>
                </div>
            </div>
        </div>

        <div class="tile">
            <div class="table-responsive mt-2">
                <p-table #dt2 [responsive]="true" [value]="headers" [tableStyle]="{'table-layout':'auto'}" [columns]="selectedColumns" [reorderableColumns]="true" styleClass="scroll-table-fhh">
                    <ng-template pTemplate="caption">
                        <div style="text-align: left">
                            <p-multiSelect appendTo="body" [options]="columnTableColumns" [(ngModel)]="selectedColumns" optionLabel="field" selectedItemsLabel="{0} columns selected" [style]="{minWidth: '200px'}" defaultLabel="Choose Columns" (onChange)="saveColumnState()"></p-multiSelect>
                        </div>
                        <div class="globalSearch">
                            <input type="text" placeholder="Global Search" [(ngModel)]="globalQuery">
                            <button class="btn btn-sm btn-primary" type="button" (click)="search()">
                                <i class="fa fa-lg fa-fw fa-search"></i>
                            </button>
                        </div>
                    </ng-template>
                    <ng-template pTemplate="header" let-columns>
                        <tr>
                            <th *ngFor="let col of columns" [pSortableColumn]="col.field">
                                {{col.header}}
                                <p-sortIcon [field]="col.field" ariaLabel="Activate to sort" ariaLabelDesc="Activate to sort in descending order" ariaLabelAsc="Activate to sort in ascending order">
                                </p-sortIcon>
                            </th>
                            <th class="fixedcol rightfixedcol">Action</th>
                        </tr>
                        <tr>
                            <th *ngFor="let col of columns" [ngSwitch]="col.field" class="ui-flclassuid">
                                <span *ngSwitchCase="'START_DATE'"></span>
                                <span *ngSwitchCase="'UPDATE_DATE'"></span>
                                <span *ngSwitchCase="'INSERT_DATE'"></span>
                                <input #statusFilter id="statusFilter" pInputText *ngSwitchCase="'STATUS'" type="text" (input)="dt2.filter($event.target.value, col.field, col.filterMatchMode)" [value]="dt2.filters[col.field]?.value" [(ngModel)]="statusDefaultFilter">
                                <input pInputText *ngSwitchDefault type="text" (input)="dt2.filter($event.target.value, col.field, col.filterMatchMode)" [value]="dt2.filters[col.field]?.value">
                            </th>
                            <th class="fixedcol rightfixedcol"></th>
                        </tr>
                    </ng-template>
                    <ng-template pTemplate="body" let-header let-columns="columns">
                        <tr [pSelectableRow]="header">
                            <td *ngFor="let col of columns">
                                <ng-container *ngIf="col.type === 'date'; else elseTemplate2">
                                    <span> {{header[col.field] | date: 'short'}} </span>
                                </ng-container>
                                <ng-template #elseTemplate2>
                                    <span> {{header[col.field]}} </span>
                                </ng-template>
                            </td>
                            <td class="fixedcol rightfixedcol" style='white-space: nowrap'>
                                <div>
                                    <button (click)="approveHeader(header)" title="Approve" *ngIf="header.STATUS === 'NEW'" class="btn btn-success btn-sm">
                                        <i class="fa fa-thumbs-up"></i>
                                    </button>
                                    <button [routerLink]="[ './edit-header', header.HEADER_HASH ]" title="Edit" *ngIf="header.STATUS === 'NEW'" class="btn btn-sm btn-primary btn-sm ml-1">
                                        <i class="fa fa-pencil"></i>
                                    </button>
                                    <button [routerLink]="[ './view-header', header.HEADER_HASH ]" title="view" class="btn btn-sm btn-info btn-sm ml-1">
                                        <i class="fa fa-eye" aria-hidden="true"></i>
                                        </button>
                                </div>
                            </td>
                        </tr>
                    </ng-template>
                </p-table>
                <div colspan="10" class="text-center p-2 border" *ngIf="!headers || !headers.length">
                    <h6>No Data Available!</h6>
                </div>
            </div>
        </div>
    </div>
</div>